# HIL platform for fixed wing autopilot – A tutorial

Due to the growing interest in drones and Unmanned Aerial Vehicles (UAVs), and consequently by Autopilots (APs), there was a need to have a tool that helps those who are researching or working, about the basic aspects of a AP. Thus, this work aims to elaborate a tutorial that describes the steps for the implementation of an autopilot Hardware in the Loop (HIL) test platform. This platform consists of a AP embedded in a dedicated microcontroller to control a simulated fixed-wing aircraft in a Matlab Simulink® programming environment. The presented structure allows its adaptation to the needs of new functionalities that want to be introduced. For this purpose, two modules that make up the AP system of a fixed-wing aircraft were loaded into the microcontroller: the control system, responsible for calculating and generating the commands for the aircraft's control surfaces so that it performs a smooth and stable flight; and the guidance system, responsible for generating the reference signals for the aircraft to carry out a predetermined flight mission. These modules were implemented from the linearized equations of the mathematical model, in steady state (trimmed), of the fixed wing aircraft model Piper J-3 Cub ¼. The navigation module, responsible for reading the sensors, has not been implemented. Instead, it was considered that this module consists of ideal sensors and all the necessary information for the control and guidance modules is provided directly from the simulated aircraft. The embedded system was made available for the Arduino platform being tested on Atmega (Arduino Uno), Expressif (Esp8266 and ESP32) and STMicroelectronics (STM32F103) microcontrollers. The communication between the HIL and the simulated aircraft takes place through Matlab Simulink® blocks and is made available through two communication protocols: asynchronous serial communication or User Datagram Protocol (UDP). The necessary steps for connection, configuration, system loading, execution on the microcontroller, modeling and simulation of the aircraft, are described in a simple and direct way allowing the end user to be able to reproduce the experiment and to adapt it according to their necessity. For this, links are available on the GitHub platform to facilitate the entire process. The results obtained are presented by successfully simulated flight missions established through pre-defined waypoints to be reached by the aircraft.
